apiVersion: kmm.sigs.x-k8s.io/v1beta1
kind: Module
metadata:
  name: moduleName
  namespace: moduleNamespace
spec:
  moduleLoader:
    container:
      modprobe:
        moduleName: neuron
        firmwarePath: "" 
      kernelMappings:
        - regexp: "^.+$"
          containerImage: driversImage
          inTreeModulesToRemove:
          - neuron
      imagePullPolicy: Always
    serviceAccountName: "awslabs-gpu-operator-kmm-module-loader"
  tolerations:
  - key: "aws-neuron-driver-upgrade"
    operator: "Equal"
    value: "true"
    effect: "NoExecute"
  selector:
    feature.node.kubernetes.io/pci-1d0f.present: "true"
